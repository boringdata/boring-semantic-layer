definitions:
  schemas:
    schema_0:
      carrier:
        op: DataType
        type: String
        nullable:
          op: bool
          value: true
      origin:
        op: DataType
        type: String
        nullable:
          op: bool
          value: true
      flight_count:
        op: DataType
        type: Int64
        nullable:
          op: bool
          value: true
      total_distance:
        op: DataType
        type: Int64
        nullable:
          op: bool
          value: true
      avg_delay:
        op: DataType
        type: Float64
        nullable:
          op: bool
          value: true
    schema_1:
      carrier:
        op: DataType
        type: String
        nullable:
          op: bool
          value: true
      origin:
        op: DataType
        type: String
        nullable:
          op: bool
          value: true
      destination:
        op: DataType
        type: String
        nullable:
          op: bool
          value: true
      flight_num:
        op: DataType
        type: String
        nullable:
          op: bool
          value: true
      flight_time:
        op: DataType
        type: Int64
        nullable:
          op: bool
          value: true
      tail_num:
        op: DataType
        type: String
        nullable:
          op: bool
          value: true
      dep_time:
        op: DataType
        type: Timestamp
        timezone: null
        scale:
          op: int
          value: '6'
        nullable:
          op: bool
          value: true
      arr_time:
        op: DataType
        type: Timestamp
        timezone: null
        scale:
          op: int
          value: '6'
        nullable:
          op: bool
          value: true
      dep_delay:
        op: DataType
        type: Int64
        nullable:
          op: bool
          value: true
      arr_delay:
        op: DataType
        type: Int64
        nullable:
          op: bool
          value: true
      taxi_out:
        op: DataType
        type: Int64
        nullable:
          op: bool
          value: true
      taxi_in:
        op: DataType
        type: Int64
        nullable:
          op: bool
          value: true
      distance:
        op: DataType
        type: Int64
        nullable:
          op: bool
          value: true
      cancelled:
        op: DataType
        type: String
        nullable:
          op: bool
          value: true
      diverted:
        op: DataType
        type: String
        nullable:
          op: bool
          value: true
      id2:
        op: DataType
        type: Int64
        nullable:
          op: bool
          value: true
  nodes:
    61632b361971d21a988b694dd1b0886a:
      op: Field
      name: distance
      relation:
        op: Read
        method_name: read_parquet
        name: ibis_read_parquet_z3bkhblfsjcdxjfeoxpjkpjuiu
        schema_ref: schema_1
        profile: 2eca7579af9a9d8e315faf6af1ddb59a_2
        read_kwargs:
        - - source_list
          - builds/3bc909873aa6/database_tables/1eaf6c62c5763815e289525d085e10e9.parquet
        - - table_name
          - ibis_read_parquet_z3bkhblfsjcdxjfeoxpjkpjuiu
        normalize_method: gAWVWAAAAAAAAACMNXhvcnEuY29tbW9uLnV0aWxzLmRhc2tfbm9ybWFsaXplLmRhc2tfbm9ybWFsaXplX3V0aWxzlIwabm9ybWFsaXplX3JlYWRfcGF0aF9tZDVzdW2Uk5Qu
      type:
        op: DataType
        type: Int64
        nullable:
          op: bool
          value: true
    7dc10719933afa9f32f82df1df69b947:
      op: Filter
      parent:
        op: Read
        method_name: read_parquet
        name: ibis_read_parquet_z3bkhblfsjcdxjfeoxpjkpjuiu
        schema_ref: schema_1
        profile: 2eca7579af9a9d8e315faf6af1ddb59a_2
        read_kwargs:
        - - source_list
          - builds/3bc909873aa6/database_tables/1eaf6c62c5763815e289525d085e10e9.parquet
        - - table_name
          - ibis_read_parquet_z3bkhblfsjcdxjfeoxpjkpjuiu
        normalize_method: gAWVWAAAAAAAAACMNXhvcnEuY29tbW9uLnV0aWxzLmRhc2tfbm9ybWFsaXplLmRhc2tfbm9ybWFsaXplX3V0aWxzlIwabm9ybWFsaXplX3JlYWRfcGF0aF9tZDVzdW2Uk5Qu
      predicates:
      - op: Greater
        args:
        - node_ref: 61632b361971d21a988b694dd1b0886a
        - op: Literal
          value: 500
          type:
            op: DataType
            type: Int16
            nullable:
              op: bool
              value: true
        type:
          op: DataType
          type: Boolean
          nullable:
            op: bool
            value: true
    aeaf811467462215d70d58c80b68d69e:
      op: Field
      name: carrier
      relation:
        node_ref: 7dc10719933afa9f32f82df1df69b947
      type:
        op: DataType
        type: String
        nullable:
          op: bool
          value: true
    8183b15d14db6c3a6e0c7a511bb84a66:
      op: Field
      name: origin
      relation:
        node_ref: 7dc10719933afa9f32f82df1df69b947
      type:
        op: DataType
        type: String
        nullable:
          op: bool
          value: true
    7532fd1fddc19b76ed6b03f721737c7e:
      op: Field
      name: distance
      relation:
        node_ref: 7dc10719933afa9f32f82df1df69b947
      type:
        op: DataType
        type: Int64
        nullable:
          op: bool
          value: true
    14e09692dee3c67f522a9e668cb373b7:
      op: Field
      name: dep_delay
      relation:
        node_ref: 7dc10719933afa9f32f82df1df69b947
      type:
        op: DataType
        type: Int64
        nullable:
          op: bool
          value: true
    afa0d4cc0dab795a820436a025d9f4b2:
      op: Field
      name: carrier
      relation:
        op: Aggregate
        parent:
          node_ref: 7dc10719933afa9f32f82df1df69b947
        by:
          carrier:
            node_ref: aeaf811467462215d70d58c80b68d69e
          origin:
            node_ref: 8183b15d14db6c3a6e0c7a511bb84a66
        metrics:
          flight_count:
            arg:
              node_ref: 7dc10719933afa9f32f82df1df69b947
            where: null
            op: CountStar
          total_distance:
            arg:
              node_ref: 7532fd1fddc19b76ed6b03f721737c7e
            where: null
            op: Sum
          avg_delay:
            arg:
              node_ref: 14e09692dee3c67f522a9e668cb373b7
            where: null
            op: Mean
      type:
        op: DataType
        type: String
        nullable:
          op: bool
          value: true
    d79cc7d3fb5fa920fe7f697231328a54:
      op: Field
      name: origin
      relation:
        op: Aggregate
        parent:
          node_ref: 7dc10719933afa9f32f82df1df69b947
        by:
          carrier:
            node_ref: aeaf811467462215d70d58c80b68d69e
          origin:
            node_ref: 8183b15d14db6c3a6e0c7a511bb84a66
        metrics:
          flight_count:
            arg:
              node_ref: 7dc10719933afa9f32f82df1df69b947
            where: null
            op: CountStar
          total_distance:
            arg:
              node_ref: 7532fd1fddc19b76ed6b03f721737c7e
            where: null
            op: Sum
          avg_delay:
            arg:
              node_ref: 14e09692dee3c67f522a9e668cb373b7
            where: null
            op: Mean
      type:
        op: DataType
        type: String
        nullable:
          op: bool
          value: true
    edaa8d4d7f57efceb4dda70c58273715:
      op: Field
      name: flight_count
      relation:
        op: Aggregate
        parent:
          node_ref: 7dc10719933afa9f32f82df1df69b947
        by:
          carrier:
            node_ref: aeaf811467462215d70d58c80b68d69e
          origin:
            node_ref: 8183b15d14db6c3a6e0c7a511bb84a66
        metrics:
          flight_count:
            arg:
              node_ref: 7dc10719933afa9f32f82df1df69b947
            where: null
            op: CountStar
          total_distance:
            arg:
              node_ref: 7532fd1fddc19b76ed6b03f721737c7e
            where: null
            op: Sum
          avg_delay:
            arg:
              node_ref: 14e09692dee3c67f522a9e668cb373b7
            where: null
            op: Mean
      type:
        op: DataType
        type: Int64
        nullable:
          op: bool
          value: true
    e3c3412e6a77206b0d57c633a2fcb1c4:
      op: Field
      name: total_distance
      relation:
        op: Aggregate
        parent:
          node_ref: 7dc10719933afa9f32f82df1df69b947
        by:
          carrier:
            node_ref: aeaf811467462215d70d58c80b68d69e
          origin:
            node_ref: 8183b15d14db6c3a6e0c7a511bb84a66
        metrics:
          flight_count:
            arg:
              node_ref: 7dc10719933afa9f32f82df1df69b947
            where: null
            op: CountStar
          total_distance:
            arg:
              node_ref: 7532fd1fddc19b76ed6b03f721737c7e
            where: null
            op: Sum
          avg_delay:
            arg:
              node_ref: 14e09692dee3c67f522a9e668cb373b7
            where: null
            op: Mean
      type:
        op: DataType
        type: Int64
        nullable:
          op: bool
          value: true
    a6738f248e8a7502969b2381e5c815b3:
      op: Field
      name: avg_delay
      relation:
        op: Aggregate
        parent:
          node_ref: 7dc10719933afa9f32f82df1df69b947
        by:
          carrier:
            node_ref: aeaf811467462215d70d58c80b68d69e
          origin:
            node_ref: 8183b15d14db6c3a6e0c7a511bb84a66
        metrics:
          flight_count:
            arg:
              node_ref: 7dc10719933afa9f32f82df1df69b947
            where: null
            op: CountStar
          total_distance:
            arg:
              node_ref: 7532fd1fddc19b76ed6b03f721737c7e
            where: null
            op: Sum
          avg_delay:
            arg:
              node_ref: 14e09692dee3c67f522a9e668cb373b7
            where: null
            op: Mean
      type:
        op: DataType
        type: Float64
        nullable:
          op: bool
          value: true
    c1652d745b6999dcbd0243a5fb990dc5:
      op: Project
      parent:
        op: Aggregate
        parent:
          node_ref: 7dc10719933afa9f32f82df1df69b947
        by:
          carrier:
            node_ref: aeaf811467462215d70d58c80b68d69e
          origin:
            node_ref: 8183b15d14db6c3a6e0c7a511bb84a66
        metrics:
          flight_count:
            arg:
              node_ref: 7dc10719933afa9f32f82df1df69b947
            where: null
            op: CountStar
          total_distance:
            arg:
              node_ref: 7532fd1fddc19b76ed6b03f721737c7e
            where: null
            op: Sum
          avg_delay:
            arg:
              node_ref: 14e09692dee3c67f522a9e668cb373b7
            where: null
            op: Mean
      values:
        carrier:
          node_ref: afa0d4cc0dab795a820436a025d9f4b2
        origin:
          node_ref: d79cc7d3fb5fa920fe7f697231328a54
        flight_count:
          node_ref: edaa8d4d7f57efceb4dda70c58273715
        total_distance:
          node_ref: e3c3412e6a77206b0d57c633a2fcb1c4
        avg_delay:
          node_ref: a6738f248e8a7502969b2381e5c815b3
    2738d0ec9b902f0a52d83f7ffd9bc55e:
      op: Field
      name: carrier
      relation:
        node_ref: c1652d745b6999dcbd0243a5fb990dc5
      type:
        op: DataType
        type: String
        nullable:
          op: bool
          value: true
    d6625ea54147e236c28eecc525b97278:
      op: Field
      name: origin
      relation:
        node_ref: c1652d745b6999dcbd0243a5fb990dc5
      type:
        op: DataType
        type: String
        nullable:
          op: bool
          value: true
    d710e3a3fca333e2c25683106c3765c4:
      op: Field
      name: flight_count
      relation:
        node_ref: c1652d745b6999dcbd0243a5fb990dc5
      type:
        op: DataType
        type: Int64
        nullable:
          op: bool
          value: true
    8aa6c8e3480341dee060a2d9b598eaa4:
      op: Field
      name: total_distance
      relation:
        node_ref: c1652d745b6999dcbd0243a5fb990dc5
      type:
        op: DataType
        type: Int64
        nullable:
          op: bool
          value: true
    2f357ac481dedf8eb01f9419a08cce98:
      op: Field
      name: avg_delay
      relation:
        node_ref: c1652d745b6999dcbd0243a5fb990dc5
      type:
        op: DataType
        type: Float64
        nullable:
          op: bool
          value: true
    3aff8e07c91e600e9a6616e90f874d2a:
      op: Project
      parent:
        node_ref: c1652d745b6999dcbd0243a5fb990dc5
      values:
        carrier:
          node_ref: 2738d0ec9b902f0a52d83f7ffd9bc55e
        origin:
          node_ref: d6625ea54147e236c28eecc525b97278
        flight_count:
          node_ref: d710e3a3fca333e2c25683106c3765c4
        total_distance:
          node_ref: 8aa6c8e3480341dee060a2d9b598eaa4
        avg_delay:
          node_ref: 2f357ac481dedf8eb01f9419a08cce98
    0b73a37bf43948542bb90e36f4328d84:
      op: Field
      name: flight_count
      relation:
        node_ref: 3aff8e07c91e600e9a6616e90f874d2a
      type:
        op: DataType
        type: Int64
        nullable:
          op: bool
          value: true
    049a8bbd40df9b26f371d33534992c64:
      op: Filter
      parent:
        node_ref: 3aff8e07c91e600e9a6616e90f874d2a
      predicates:
      - op: Greater
        args:
        - node_ref: 0b73a37bf43948542bb90e36f4328d84
        - op: Literal
          value: 50
          type:
            op: DataType
            type: Int8
            nullable:
              op: bool
              value: true
        type:
          op: DataType
          type: Boolean
          nullable:
            op: bool
            value: true
    d3ba8db3f7dbe9f0b0cbbfe608eaf3d9:
      op: Field
      name: total_distance
      relation:
        node_ref: 049a8bbd40df9b26f371d33534992c64
      type:
        op: DataType
        type: Int64
        nullable:
          op: bool
          value: true
expression:
  op: Tag
  schema_ref: schema_0
  parent:
    op: Limit
    parent:
      op: Sort
      parent:
        node_ref: 049a8bbd40df9b26f371d33534992c64
      keys:
      - op: SortKey
        arg:
          node_ref: d3ba8db3f7dbe9f0b0cbbfe608eaf3d9
        ascending: false
        nulls_first: false
        type:
          op: DataType
          type: Int64
          nullable:
            op: bool
            value: true
    n: 20
    offset: 0
  metadata:
    op: FrozenOrderedDict
    tag:
      op: str
      value: bsl
    bsl_op_type:
      op: str
      value: SemanticLimitOp
    bsl_version:
      op: str
      value: '1.0'
    n:
      op: int
      value: '20'
    offset:
      op: int
      value: '0'
    source:
      op: tuple
      values:
      - op: tuple
        values:
        - op: str
          value: bsl_op_type
        - op: str
          value: SemanticOrderByOp
      - op: tuple
        values:
        - op: str
          value: bsl_version
        - op: str
          value: '1.0'
      - op: tuple
        values:
        - op: str
          value: order_keys
        - op: tuple
          values:
          - op: tuple
            values:
            - op: tuple
              values:
              - op: str
                value: type
              - op: str
                value: callable
            - op: tuple
              values:
              - op: str
                value: value
              - op: str
                value: _.total_distance(_).desc(nulls_first=False)
      - op: tuple
        values:
        - op: str
          value: source
        - op: tuple
          values:
          - op: tuple
            values:
            - op: str
              value: bsl_op_type
            - op: str
              value: SemanticFilterOp
          - op: tuple
            values:
            - op: str
              value: bsl_version
            - op: str
              value: '1.0'
          - op: tuple
            values:
            - op: str
              value: predicate
            - op: str
              value: (_.flight_count > 50)
          - op: tuple
            values:
            - op: str
              value: source
            - op: tuple
              values:
              - op: tuple
                values:
                - op: str
                  value: bsl_op_type
                - op: str
                  value: SemanticAggregateOp
              - op: tuple
                values:
                - op: str
                  value: bsl_version
                - op: str
                  value: '1.0'
              - op: tuple
                values:
                - op: str
                  value: by
                - op: tuple
                  values:
                  - op: str
                    value: carrier
                  - op: str
                    value: origin
              - op: tuple
                values:
                - op: str
                  value: aggs
                - op: tuple
                  values:
                  - op: tuple
                    values:
                    - op: str
                      value: flight_count
                    - op: str
                      value: _['flight_count']
                  - op: tuple
                    values:
                    - op: str
                      value: total_distance
                    - op: str
                      value: _['total_distance']
                  - op: tuple
                    values:
                    - op: str
                      value: avg_delay
                    - op: str
                      value: _['avg_delay']
              - op: tuple
                values:
                - op: str
                  value: source
                - op: tuple
                  values:
                  - op: tuple
                    values:
                    - op: str
                      value: bsl_op_type
                    - op: str
                      value: SemanticGroupByOp
                  - op: tuple
                    values:
                    - op: str
                      value: bsl_version
                    - op: str
                      value: '1.0'
                  - op: tuple
                    values:
                    - op: str
                      value: keys
                    - op: tuple
                      values:
                      - op: str
                        value: carrier
                      - op: str
                        value: origin
                  - op: tuple
                    values:
                    - op: str
                      value: source
                    - op: tuple
                      values:
                      - op: tuple
                        values:
                        - op: str
                          value: bsl_op_type
                        - op: str
                          value: SemanticFilterOp
                      - op: tuple
                        values:
                        - op: str
                          value: bsl_version
                        - op: str
                          value: '1.0'
                      - op: tuple
                        values:
                        - op: str
                          value: predicate
                        - op: str
                          value: (_.distance > 500)
                      - op: tuple
                        values:
                        - op: str
                          value: source
                        - op: tuple
                          values:
                          - op: tuple
                            values:
                            - op: str
                              value: bsl_op_type
                            - op: str
                              value: SemanticTableOp
                          - op: tuple
                            values:
                            - op: str
                              value: bsl_version
                            - op: str
                              value: '1.0'
                          - op: tuple
                            values:
                            - op: str
                              value: dimensions
                            - op: tuple
                              values: []
                          - op: tuple
                            values:
                            - op: str
                              value: measures
                            - op: tuple
                              values:
                              - op: tuple
                                values:
                                - op: str
                                  value: flight_count
                                - op: tuple
                                  values:
                                  - op: tuple
                                    values:
                                    - op: str
                                      value: description
                                    - null
                                  - op: tuple
                                    values:
                                    - op: str
                                      value: requires_unnest
                                    - op: tuple
                                      values: []
                                  - op: tuple
                                    values:
                                    - op: str
                                      value: expr
                                    - op: str
                                      value: _.count()
                              - op: tuple
                                values:
                                - op: str
                                  value: total_distance
                                - op: tuple
                                  values:
                                  - op: tuple
                                    values:
                                    - op: str
                                      value: description
                                    - null
                                  - op: tuple
                                    values:
                                    - op: str
                                      value: requires_unnest
                                    - op: tuple
                                      values: []
                                  - op: tuple
                                    values:
                                    - op: str
                                      value: expr
                                    - op: str
                                      value: _.distance.sum()
                              - op: tuple
                                values:
                                - op: str
                                  value: avg_delay
                                - op: tuple
                                  values:
                                  - op: tuple
                                    values:
                                    - op: str
                                      value: description
                                    - null
                                  - op: tuple
                                    values:
                                    - op: str
                                      value: requires_unnest
                                    - op: tuple
                                      values: []
                                  - op: tuple
                                    values:
                                    - op: str
                                      value: expr
                                    - op: str
                                      value: _.dep_delay.mean()
                          - op: tuple
                            values:
                            - op: str
                              value: name
                            - op: str
                              value: flights
